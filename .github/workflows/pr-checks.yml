name: PR Checks

on:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  # VerificaÃ§Ãµes bÃ¡sicas para PRs
  pr-validation:
    name: ValidaÃ§Ã£o de PR
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“¥ Checkout cÃ³digo
      uses: actions/checkout@v4
      with:
        fetch-depth: 0

    - name: ğŸ¯ Setup Flutter
      uses: subosito/flutter-action@v2
      with:
        flutter-version: 'stable'
        channel: 'stable'
        cache: true

    - name: ğŸ“¦ Instalar dependÃªncias
      run: flutter pub get

    - name: ğŸ” Verificar formataÃ§Ã£o
      run: dart format --set-exit-if-changed .
      continue-on-error: true

    - name: ğŸ” AnÃ¡lise estÃ¡tica
      run: flutter analyze --fatal-infos

    - name: ğŸ§ª Executar testes
      run: flutter test

    - name: ğŸ“ Verificar mensagem do commit
      run: |
        git log --format=%B -n 1 ${{ github.event.pull_request.head.sha }} | grep -qE "^(feat|fix|docs|style|refactor|test|chore)(\(.+\))?: .+"
      continue-on-error: true

    - name: âœ… PR Validado
      run: echo "âœ… Pull Request validado com sucesso!"
